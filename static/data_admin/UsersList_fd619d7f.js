(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{596:function(e,t,a){"use strict";a.r(t);var n=a(50),r=a.n(n),o=a(51),i=a.n(o),u=a(52),s=a.n(u),c=a(20),l=a.n(c),d=a(53),p=a.n(d),m=a(5),b=a.n(m),f=a(0),k=a.n(f),h=a(74),D=a(15),R=a(73),g=a.n(R),L=a(114),T=a(54),_=a(391),v=a.n(_),E=a(75),A=a(72),S=a.n(A),C=a(599),w=a(117),O=a(600),y=a(115),z=a(27),U=a(131),x=a(116),F=Object(f.lazy)((function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,602))})),j=Object(f.lazy)((function(){return Promise.all([a.e(0),a.e(7)]).then(a.bind(null,612))})),N=Object(f.lazy)((function(){return a.e(10).then(a.bind(null,611))})),Z=function(e){function t(e){var a;return r()(this,t),a=i()(this,s()(t).call(this,e)),b()(l()(a),"componentDidMount",(function(){a.props.appDataRuntime.token?v.a.parse(window.location.search).reload&&a.usersListTable.current&&a.usersListTable.current.reloadURL():E.b.push("/admin/users/auth?redirect=/admin/users")})),b()(l()(a),"deauthorize",(function(){a.props.appDataRuntimeSetTokenAction(null),a.props.appDataSetUserAction({}),Object(L.remove)("".concat(z.id,"_auth")),E.b.push("/admin/users/auth?redirect=/admin/users")})),b()(l()(a),"onUsersTableLoadError",(function(e){e&&403===e.status&&(a.deauthorize(),a.props.usersListTableSetStateAction({}))})),b()(l()(a),"onUsersTableSaveError",(function(e,t){if(e)switch(403===e.statusCode&&a.deauthorize(),e.errorCode){case 1:S.a.notification(t._({id:"Record with the entered value already exists"}),{status:"danger"});break;case 2:S.a.notification(t._({id:"Invalid format"}),{status:"danger"});break;default:S.a.notification(t._({id:"Could not save data"}),{status:"danger"})}else S.a.notification(t._({id:"Could not save data"}),{status:"danger"})})),b()(l()(a),"onTableStateUpdated",(function(e){return a.props.usersListTableSetStateAction(e)})),b()(l()(a),"onDeleteRecord",(function(e,t){t&&t.preventDefault();var n=[],r=[];if(e&&t){n.push(e);var o=a.usersListTable.current.getCurrentData();r.push(o.username[e])}else{a.usersListTable.current.getCheckboxData().map((function(e){n.push(e._id),r.push(e.username)}))}n.length&&a.dialogDelete.current.show(r,n)})),b()(l()(a),"onDeleteButtonClick",(function(e,t){a.dialogDelete.current.hide(),a.usersListTable.current.setLoading(!0),g.a.post("".concat(y.url,"/api/users/delete"),{token:a.props.appDataRuntime.token,ids:e},{headers:{"content-type":"application/json"}}).then((function(e){return a.usersListTable.current.setLoading(!1),200!==e.data.statusCode?S.a.notification(t._({id:"Cannot delete one or more users"}),{status:"danger"}):(a.usersListTable.current.reloadURL(),S.a.notification(t._({id:"Operation complete"}),{status:"success"}))})).catch((function(){return a.usersListTable.current.setLoading(!1)&&S.a.notification(t._({id:"Cannot delete one or more users"}),{status:"danger"})}))})),b()(l()(a),"onRefreshTable",(function(e){e.preventDefault(),a.usersListTable.current&&a.usersListTable.current.reloadURL()})),b()(l()(a),"render",(function(){return k.a.createElement(F,null,k.a.createElement(h.I18n,null,(function(e){var t=e.i18n;return a.props.appDataRuntimeSetDocumentTitleAction(t._({id:"Users"}),a.props.appData.language,a.props.appDataRuntime.config.siteTitle),k.a.createElement(k.a.Fragment,null,k.a.createElement("div",{className:"uk-title-head uk-margin-bottom"},t._({id:"Users"})),k.a.createElement(j,{prefix:"usersListTable",ref:a.usersListTable,initialState:a.props.usersList.usersTableState,onStateUpdated:a.onTableStateUpdated,i18n:t,UIkit:S.a,axios:g.a,topButtons:k.a.createElement(k.a.Fragment,null,k.a.createElement(T.a,{to:"/admin/users/add",className:"uk-icon-button uk-button-primary uk-margin-small-right","uk-icon":"plus","uk-tooltip":t._({id:"Create new user"})}),k.a.createElement("button",{type:"button",className:"uk-icon-button uk-button-danger uk-margin-right","uk-icon":"trash","uk-tooltip":t._({id:"Delete selected users"}),onClick:function(e){return a.onDeleteRecord(null,e)}}),k.a.createElement("button",{type:"button",className:"uk-icon-button uk-button-default","uk-icon":"refresh","uk-tooltip":t._({id:"Refresh"}),onClick:a.onRefreshTable})),columns:[{id:"username",title:"Username",sortable:!0,editable:"text",cssHeader:"uk-width-1-6@m uk-text-nowrap",validation:{mandatory:!0,regexp:"^[A-Za-z0-9_-]{4,32}$"}},{id:"email",title:"E-mail",sortable:!0,process:function(e){return e||""},editable:"text",validation:{mandatory:!0,regexp:"^(?:[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-])+@(?:[a-zA-Z0-9]|[^\\u0000-\\u007F])(?:(?:[a-zA-Z0-9-]|[^\\u0000-\\u007F]){0,61}(?:[a-zA-Z0-9]|[^\\u0000-\\u007F]))?(?:\\.(?:[a-zA-Z0-9]|[^\\u0000-\\u007F])(?:(?:[a-zA-Z0-9-]|[^\\u0000-\\u007F]){0,61}(?:[a-zA-Z0-9]|[^\\u0000-\\u007F]))?)*$"}},{id:"active",title:"Status",cssRow:"uk-width-small uk-text-nowrap ztable-noselect",sortable:!0,process:function(e){return e?1:0},editable:"select",options:{0:"Inactive",1:"Active"}},{id:"actions",title:"Actions",cssRow:"uk-table-shrink uk-text-nowrap ztable-noselect",process:function(e,n){return k.a.createElement(k.a.Fragment,null,k.a.createElement(T.a,{to:"/admin/users/edit/".concat(n._id),className:"uk-icon-button","uk-icon":"pencil","uk-tooltip":"title: ".concat(t._({id:"Edit"}))})," ",k.a.createElement("a",{href:"",className:"uk-icon-button","uk-icon":"trash","uk-tooltip":"title: ".concat(t._({id:"Delete"})),onClick:function(e){return a.onDeleteRecord(n._id,e)}}))}}],itemsPerPage:a.props.appDataRuntime.config.commonItemsLimit,source:{url:"".concat(y.url,"/api/users/list"),method:"POST",extras:{token:a.props.appDataRuntime.token}},save:{url:"".concat(y.url,"/api/users/save/field"),method:"POST",extras:{token:a.props.appDataRuntime.token}},sortColumn:"username",sortDirection:"asc",lang:{LOADING:t._({id:"Loading data, please wait…"}),NO_RECORDS:t._({id:"No records to display"}),ERROR_LOAD:t._({id:"Could not load data"}),ERROR_SAVE:t._({id:"Could not save data"}),ERR_VMANDATORY:t._({id:"Field is required"}),ERR_VFORMAT:t._({id:"Invalid format"})},onLoadError:a.onUsersTableLoadError,onSaveError:function(e){return a.onUsersTableSaveError(e,t)}}),k.a.createElement(N,{ref:a.dialogDelete,i18n:t,onDeleteButtonClickHandler:function(e){return a.onDeleteButtonClick(e,t)}}))})))})),a.usersListTable=k.a.createRef(),a.dialogDelete=k.a.createRef(),a}return p()(t,e),t}(f.Component);t.default=Object(D.c)((function(e){return{appData:e.appData,appDataRuntime:e.appDataRuntime,appLingui:e.appLingui,usersList:e.usersList}}),(function(e){return{appDataRuntimeSetTokenAction:function(t){return e(Object(C.a)(t))},appDataSetUserAction:function(t){return e(Object(O.a)(t))},usersListTableSetStateAction:function(t){return e((a=t,{type:U.a,payload:a}));var a},appLinguiSetCatalogAction:function(t,a){return e(Object(w.a)(t,a))},appDataRuntimeSetDocumentTitleAction:function(t,a,n){return e(Object(x.a)(t,a,n))}}}))(Z)},599:function(e,t,a){"use strict";var n=a(9);t.a=function(e){return{type:n.c,payload:e}}},600:function(e,t,a){"use strict";var n=a(9);t.a=function(e){return{type:n.e,payload:e}}}}]);